#!/bin/python3

from src.SharedFunctions import *
from src.Initialization import *
from src.DaemonicPipe import *
from src.AnnoFit import *

files = ["/dev/datasets/FairWind/_results/Schachtschneider_Exomes/Schachtschneider_A10SH/Schachtschneider_A10SH.unfiltered.vcf", "/dev/datasets/FairWind/_results/Schachtschneider_Exomes/Schachtschneider_A11SH/Schachtschneider_A11SH.unfiltered.vcf", "/dev/datasets/FairWind/_results/Schachtschneider_Exomes/Schachtschneider_A12SH/Schachtschneider_A12SH.unfiltered.vcf", "/dev/datasets/FairWind/_results/Schachtschneider_Exomes/Schachtschneider_A13SH/Schachtschneider_A13SH.unfiltered.vcf", "/dev/datasets/FairWind/_results/Schachtschneider_Exomes/Schachtschneider_A14SH/Schachtschneider_A14SH.unfiltered.vcf", "/dev/datasets/FairWind/_results/Schachtschneider_Exomes/Schachtschneider_A15SH/Schachtschneider_A15SH.unfiltered.vcf", "/dev/datasets/FairWind/_results/Schachtschneider_Exomes/Schachtschneider_A16SH/Schachtschneider_A16SH.unfiltered.vcf", "/dev/datasets/FairWind/_results/Schachtschneider_Exomes/Schachtschneider_A17SH/Schachtschneider_A17SH.unfiltered.vcf", "/dev/datasets/FairWind/_results/Schachtschneider_Exomes/Schachtschneider_A18SH/Schachtschneider_A18SH.unfiltered.vcf", "/dev/datasets/FairWind/_results/Schachtschneider_Exomes/Schachtschneider_A19SH/Schachtschneider_A19SH.unfiltered.vcf", "/dev/datasets/FairWind/_results/Schachtschneider_Exomes/Schachtschneider_A1SH/Schachtschneider_A1SH.unfiltered.vcf", "/dev/datasets/FairWind/_results/Schachtschneider_Exomes/Schachtschneider_A20SH/Schachtschneider_A20SH.unfiltered.vcf", "/dev/datasets/FairWind/_results/Schachtschneider_Exomes/Schachtschneider_A21SH/Schachtschneider_A21SH.unfiltered.vcf", "/dev/datasets/FairWind/_results/Schachtschneider_Exomes/Schachtschneider_A22SH/Schachtschneider_A22SH.unfiltered.vcf", "/dev/datasets/FairWind/_results/Schachtschneider_Exomes/Schachtschneider_A23SH/Schachtschneider_A23SH.unfiltered.vcf", "/dev/datasets/FairWind/_results/Schachtschneider_Exomes/Schachtschneider_A24SH/Schachtschneider_A24SH.unfiltered.vcf", "/dev/datasets/FairWind/_results/Schachtschneider_Exomes/Schachtschneider_A25SH/Schachtschneider_A25SH.unfiltered.vcf", "/dev/datasets/FairWind/_results/Schachtschneider_Exomes/Schachtschneider_A26SH/Schachtschneider_A26SH.unfiltered.vcf", "/dev/datasets/FairWind/_results/Schachtschneider_Exomes/Schachtschneider_A27SH/Schachtschneider_A27SH.unfiltered.vcf", "/dev/datasets/FairWind/_results/Schachtschneider_Exomes/Schachtschneider_A28SH/Schachtschneider_A28SH.unfiltered.vcf", "/dev/datasets/FairWind/_results/Schachtschneider_Exomes/Schachtschneider_A29SH/Schachtschneider_A29SH.unfiltered.vcf", "/dev/datasets/FairWind/_results/Schachtschneider_Exomes/Schachtschneider_A2SH/Schachtschneider_A2SH.unfiltered.vcf", "/dev/datasets/FairWind/_results/Schachtschneider_Exomes/Schachtschneider_A30SH/Schachtschneider_A30SH.unfiltered.vcf", "/dev/datasets/FairWind/_results/Schachtschneider_Exomes/Schachtschneider_A3SH/Schachtschneider_A3SH.unfiltered.vcf", "/dev/datasets/FairWind/_results/Schachtschneider_Exomes/Schachtschneider_A4SH/Schachtschneider_A4SH.unfiltered.vcf", "/dev/datasets/FairWind/_results/Schachtschneider_Exomes/Schachtschneider_A5SH/Schachtschneider_A5SH.unfiltered.vcf", "/dev/datasets/FairWind/_results/Schachtschneider_Exomes/Schachtschneider_A6SH/Schachtschneider_A6SH.unfiltered.vcf", "/dev/datasets/FairWind/_results/Schachtschneider_Exomes/Schachtschneider_A7SH/Schachtschneider_A7SH.unfiltered.vcf", "/dev/datasets/FairWind/_results/Schachtschneider_Exomes/Schachtschneider_A8SH/Schachtschneider_A8SH.unfiltered.vcf", "/dev/datasets/FairWind/_results/Schachtschneider_Exomes/Schachtschneider_A9SH/Schachtschneider_A9SH.unfiltered.vcf"]

PipelineConfig = json.load(open("/dev/datasets/FairWind/.cloud/core/labjournal/tools/Scissors/config/DaemonicPipeline_config.json", 'rt'))
Logger = DefaultLogger("/dev/null")

#lst = ["DCFED13-JULTH13", "DCMIH23-JULTH23", "DCSAN1-QUAR1", "DCVAS3-QUAR3"]

#for item in lst: CoverageStats(f"{item}.FR300", f"/dev/datasets/FairWind/_results/FR300/{item}.FR150.sorted.bam", f"/dev/datasets/FairWind/_results/FR300/{item}.FR150.stats.txt", PipelineConfig["Capture"], PipelineConfig["NotCapture"], PipelineConfig["Reference"], Logger)

for item in files:
	ANNOVAR(item, item + ".tsv", PipelineConfig["AnnovarDatabases"], PipelineConfig["AnnovarDBFolder"], PipelineConfig["AnnovarFolder"], PipelineConfig["GenomeAssembly"], Logger, Threads=PipelineConfig["Threads"])
	AnnoFit(item + ".tsv", item + ".xlsx", PipelineConfig["HGMDPath"], PipelineConfig["AnnovarFolder"], PipelineConfig["AnnoFitConfig"], Logger, PipelineConfig["AnnofitChunkSize"], Threads=PipelineConfig["Threads"])

# gatk FastqToSam -F {R1} -F2 {R2} -O {uBAM} --SAMPLE_NAME S1
# gatk MarkIlluminaAdapters -I {uBAM} --M {MarkAdaptersMetrics} -O {uBAMxt}
# gatk SamToFastq -I {uBAMxt} -F {TrimmedR1} --F2 {TrimmedR2} --CLIPPING_ACTION X --CLIPPING_ATTRIBUTE XT
#
